// Uses native fetch API to replace axios calls

const API_URL = "http://127.0.0.1:8000";

async function safeFetch(url, options = {}) {
    try {
        const response = await fetch(url, options);
        const data = await response.json();

        if (!response.ok) {
            throw { 
                status: response.status, 
                detail: data.detail || 'An unknown error occurred',
                data: data
            };
        }
        return data;
    } catch (error) {
        console.error("API Fetch Error:", error);
        throw error;
    }
}

export const predictMalware = async (features, token) => {
    return safeFetch(`${API_URL}/predict`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}` // Include Authorization header
        },
        body: JSON.stringify({ values: features })
    });
};